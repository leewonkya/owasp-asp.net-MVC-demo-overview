@{
    ViewBag.title = "Missing Function Level Access";
}
<div class="row">
    <div class="col-12">
        <div class="tab">

            <div class="d-flex align-items-center justify-content-between w-100">
                <div class="page-number h2">
                    <span class="number">7.</span> Missing Function Level Access
                </div>
                <a href="/">Back to index</a>
            </div>

            <div id="smartwizard">
                <ul class="nav">
                    <li>
                        <a class="nav-link" href="#step-1">
                            Tìm hiểu về Missing Function Level Access Control
                        </a>
                    </li>
                    <li>
                        <a class="nav-link" href="#step-2"> Hướng giải quyết </a>
                    </li>
                    <li>
                        <a class="nav-link" href="#step-3"> Demo sau khi Ngăn lỗi </a>
                    </li>
                </ul>

                <div class="tab-content">
                    <div id="step-1" class="tab-pane" role="tabpanel">
                        <div class="content">
                            <p class="h4">Định nghĩa</p>
                            <div class="ml-4">
                                <p>
                                    Hầu hết các trang web đều có 1 hàm phân quyền cho người
                                    dùng. Nhưng nếu hàm đó không được đồng bộ thực hiện đúng
                                    đắn như phía người dùng thì kẻ tấn công có thể được lợi
                                    dụng lỗ hỏng này để tấn công vào trang web với những đặc
                                    quyền cao hơn.
                                </p>
                                <p>
                                    Missing Function Level Access Control (lỗi phân quyền) là sự thiếu sót trong quá trình phân quyền. Có nghĩa là trong hệ thống của bạn, ở đâu đó có một chức năng hay một trang nào đó mà chỉ những tài khoản là quản trị viên mới được phép truy cập vào. Nhưng họ không ngờ là chính sự thiếu sót trong việc phân quyền mà các tài khoản khác lại có thể truy cập vào đó.
                                </p>
                                <p>
                                    Lỗi phân quyền cũng chính là một trong những lỗi phổ biến mà các lập trình viên thường mắc phải, một trong số lỗ hỏng đó phổ biến là bảo mật đăng nhập và quản lý tài khoản người dùng.
                                </p>
                                <p>
                                    Những sai sót này được bắt đầu từ khâu thiết kế cơ sở dữ liệu. Việc thiết kế sơ sài dẫn đến nhiều vấn đề nãy sinh khi ta bắt đầu thực hiện dự án, và khi cấu trúc dữ liệu kém logic hoặc không rõ ràng để thực hiện phân quyền dẫn đến việc lập trình sẽ trở nên khó hơn và sơ sài hơn trong khâu phân quyền chức năng cho người dùng.
                                </p>
                                <p>Hãy thử truy cập vào trang quản trị bằng cách dán đường link <span class="high-light">localhost:{your hosting}/admin/homeAdmin/Index2</span> lên thanh URL của bạn. Nếu phía server không ràng buộc kỹ càng thì Attackers có thể truy cập vào và phá hoại toàn bộ thông tin, dữ liệu của hệ thống</p>
                            </div>
                        </div>

                    </div>
                    <div id="step-2" class="tab-pane" role="tabpanel">
                        <p class="h4">Missing Function Level Access Control thuộc lỗ hỏng phân quyền, vậy nên ta có thể phòng chống như sau:</p>
                        <ol class="ml-5">
                            <li>
                                <p>
                                    Phải yêu cầu truy cập, kiểm tra quyền của người dùng. Nếu người dùng thuộc
                                    tài khoản quản trị viên cho phép truy cập thẳng vào trang quản trị. Còn
                                    người dùng chỉ thuộc quyền người dùng thì truy cập vào trang người dùng.
                                </p>
                            </li>
                            <li>
                                <p>
                                    Phân tích kỹ mô hình của hệ thống trước khi thực hiện thiết kế database.
                                </p>
                            </li>
                            <li>
                                <p>
                                    Thay vì sử dụng Database First thì chúng ta nên sử dụng Code Frist để dễ dàng thay đổi cấu trúc dữ liệu trước khi dữ liệu ngày càng lớn.
                                </p>
                            </li>
                            <li>
                                <p>
                                    Sử dụng JWT (Json Web Token) để thực hiện Authentication để xác thực người dùng.
                                </p>
                            </li>
                            <li>
                                <p>
                                    Giới hạn chức năng cho người dùng. Các phương thức yêu cầu thông qua API như POST, PUT, DELETE cần phải được xác thực trước khi thực hiện.
                                </p>
                            </li>
                        </ol>
                    </div>
                    <div id="step-3" class="tab-pane" role="tabpanel">
                        <div class="content">
                            <p>Việc truy cập vào trang quản trị mà không thông qua đăng nhập hoặc xác minh tài khoản quá nguy hiểm. Giả sử kẻ tấn công có thể dò ra đường địa chỉ của trang thì mọi dữ liệu của hệ thống có thể dẫn tới bị xóa mất.</p>
                            <p>Giờ hãy thử đăng nhập với 2 tài khoản <span class="high-light">user1 - user1</span> hoặc <span class="high-light">admin - admin</span></p>
                            <p>hãy thử tấn công lại bằng cách truy cập vào đường link như sau <span class="high-light">localhost:{your hosting}/adminowasp/HomeAdmin/Index2</span></p>
                        </div>
                        <div class="demo d-flex">
                            <div class="form-group">
                                @using (Html.BeginForm("LoginWithOwasp", "MissingFunctionLevelAccessControl", FormMethod.Post))
                                {
                                    <input type="text"
                                           class="form-control font-small mb-3"
                                           name="username"
                                           placeholder="Nhập vào tài khoản" />
                                    <input type="password"
                                           class="form-control font-small mb-3"
                                           name="password"
                                           placeholder="Nhập vào mật khẩu" />
                                    <button type="submit"
                                            class="btn btn-primary btn-sm px-3 py-1">
                                        Đăng nhập
                                    </button>
                                }
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>