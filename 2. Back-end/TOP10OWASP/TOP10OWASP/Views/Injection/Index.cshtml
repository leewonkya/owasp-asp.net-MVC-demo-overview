<div class="row">
    <div class="col-12">
        <div class="tab">
            <div class="page-number h2">
                <span class="number">1.</span> Injection
                <a href="/" class="mr-auto">Back to index</a>
                <p>@ViewBag.message</p>
            </div>


            <div id="smartwizard">
                <ul class="nav">
                    <li>
                        <a class="nav-link" href="#step-1"> Tìm hiểu về Injection </a>
                    </li>
                    <li>
                        <a class="nav-link" href="#step-2"> Hướng giải quyết </a>
                    </li>
                    <li>
                        <a class="nav-link" href="#step-3"> Demo sau khi Ngăn lỗi Injection </a>
                    </li>
                </ul>

                <div class="tab-content">
                    <div id="step-1" class="tab-pane" role="tabpanel">
                        <div class="content">
                            <p>
                                SQL Injection là một kỹ thuật lợi dụng những lỗ hổng về câu truy
                                vấn của các ứng dụng. Được thực hiện bằng cách chèn thêm một
                                đoạn SQL để làm sai lệnh đi câu truy vấn ban đầu, từ đó có thể
                                khai thác dữ liệu từ database. SQL injection có thể cho phép
                                những kẻ tấn công thực hiện các thao tác như một người quản trị
                                web, trên cơ sở dữ liệu của ứng dụng.
                            </p>
                            <p>
                                Thông thường các nơi bị tấn công sẽ là các ô nhập liệu ở bất kỳ
                                đâu trên website của bạn!
                            </p>
                            <p>
                                Dữ liệu tấn công sẽ có 2 loại là:
                                <strong>String text</strong> và <strong>Number</strong>
                            </p>
                            <p>Giả sử, website chúng ta có chức năng là đăng nhập.</p>
                            <p>Hãy thực hiện chức năng đăng nhập với tài khoản là <span class="high-light">admin</span> và mật khẩu là <span class="high-light">admin</span></p>
                            <p>
                                Giờ hãy thử Nhập vào cả 2 ô Dữ liệu theo ví dụ như sau
                                <span class="high-light">Dev' or 'a'='a</span>
                            </p>
                        </div>
                        <div class="demo d-flex">
                            <div class="form-group">
                                @using (Html.BeginForm("LoginByInjection", "Injection", FormMethod.Post))
                                {
                                    <input type="text"
                                           class="form-control font-small mb-3"
                                           name="username"
                                           placeholder="Nhập vào tài khoản" />
                                    <input type="password"
                                           class="form-control font-small mb-3"
                                           name="password"
                                           placeholder="Nhập vào mật khẩu" />
                                    <button type="submit"
                                            class="btn btn-primary btn-sm px-3 py-1">
                                        Đăng nhập
                                    </button>
                                }
                            </div>
                        </div>
                    </div>
                    <div id="step-2" class="tab-pane" role="tabpanel">
                        <pre>
                        <code class="C#">
          public class Customer : IIdEntity<int>
                          {
                              public int Id { get; set; }
                              public string Name { get; set; }
                              public string Address { get; set; }
                              public string Email { get; set; }
                              public string Phone { get; set; }
                              public CustomerStatus Status { get; set; }
                              public DateTime CreatedDate { get; set; }
                              public virtual int? CustomerTypeId { get; set; }
                              public virtual CustomerType CustomerType { get; set; }
                          }
                      </code>
                    </pre>
                    </div>
                    <div id="step-3" class="tab-pane" role="tabpanel">
                        
                        <div class="demo d-flex">
                            <div class="form-group">
                                @using (Html.BeginForm("LoginByOwasp", "Injection", FormMethod.Post, new { @id = "formOwasp" }))
                                {
                                    <input type="text"
                                           class="form-control font-small mb-3"
                                           name="username"                                           
                                           placeholder="Nhập vào tài khoản"
                                           id="username"
                                           required />                                           
                                    <input type="password"
                                           class="form-control font-small mb-3"
                                           name="password"
                                           placeholder="Nhập vào mật khẩu" 
                                           id="password"
                                           required/>
                                    <p class="errorText text-danger pl-2 alert-danger"></p>
                                    <button type="button"
                                            class="btn btn-primary btn-sm px-3 py-1 " id="btn-submit">
                                        Đăng nhập
                                    </button>
                                }
                            </div>
                        </div>                       
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
@section scripts{
    <script>
        $("#btn-submit").click(function () {
            var data = $("#formOwasp").serialize();
            $.ajax({
                url: "@Url.Action("LoginByOwasp", "Injection")",
                type: "GET",
                data: data,
                dataType: "json",
                contentType: "application/json; charset=utf-8",
                async: true,
                processData: false,
                cache: false,
                success: function (response) {
                        alert(response);
                    
                },
                error: function (xhr) {
                    console.log("xhr", xhr);
                }

            });
        });
    //const regex = "<(|\/|[^\/>][^>]+|\/[^>][^>]+)>";
    //const handleValidate = () => {
    //  let username = document.querySelector("#username");
    //  let password = document.querySelector("#password");
    //  let error = document.querySelector(".errorText");
    //  if (username.value == "" || password.value == "") {
    //    error.innerText = "Dữ liệu không được để trống";
    //      username.classList.add("error");
    //      username.focus();
    //      password.classList.add("error");
    //      password.focus();
    //    return false;
    //  }
    //  else if (username.value.match(regex) || password.value.match(regex)) {
    //    error.innerText = "Dữ liệu nhập vào không hợp lệ!!";
    //      username.classList.add("error");
    //      username.focus();
    //      password.classList.add("error");
    //      password.focus();
    //    return false;
    //  }
    //  else{
    //    return true;
    //  }
    //};

    </script>    
}